id: https://arw.dev/schema/ARWManifest
name: arw_model
version: 0.1
prefixes:
  arw: https://arw.dev/schema/
  linkml: https://w3id.org/linkml/
default_prefix: arw
default_range: string
imports:
  - linkml:types

enums:
  ARWProfile:
    permissible_values:
      ARW-1: {}
      ARW-2: {}
      ARW-3: {}
      ARW-4: {}

  Priority:
    permissible_values:
      high: {}
      medium: {}
      low: {}

  HTTPMethod:
    permissible_values:
      GET: {}
      POST: {}
      PUT: {}
      PATCH: {}
      DELETE: {}

  AuthType:
    permissible_values:
      oauth2: {}
      api_key: {}
      none: {}

  SerializationFormat:
    description: Supported serialization formats
    permissible_values:
      yaml:
        description: YAML format with text/plain Content-Type
      json:
        description: JSON format with application/json Content-Type

  DiscoveryMethod:
    description: Mechanisms for ARW manifest discovery
    permissible_values:
      robots_txt:
        description: robots.txt hints (e.g., ARW-Guide, ARW-Manifest)
      well_known:
        description: .well-known/arw-manifest.json discovery
      http_headers:
        description: HTTP response headers (AI-*)
      meta_tags:
        description: HTML meta tags for ARW endpoints

  MimeType:
    description: MIME types for ARW content
    permissible_values:
      text_plain:
        description: text/plain (for YAML llms.txt)
        meaning: text/plain
      application_json:
        description: application/json (for JSON manifests)
        meaning: application/json
      text_markdown:
        description: text/markdown (for .llm.md files)
        meaning: text/markdown

types:
  url:
    base: uri
  email:
    base: string
    pattern: '^[^@\s]+@[^@\s]+\.[^@\s]+$'

slots:
  # Root manifest slots
  version:
    description: Specification version of ARW manifest
    range: string
    required: true

  profile:
    description: Conformance profile
    range: ARWProfile
    required: true

  site:
    range: Site
    required: true

  content:
    range: ContentItem
    multivalued: true

  actions:
    range: Action
    multivalued: true

  protocols:
    range: Protocol
    multivalued: true

  oauth:
    range: OAuthConfig

  policies:
    range: Policies
    required: true

  # NEW: Format and discovery metadata
  metadata:
    description: Format, discovery, and compatibility metadata
    range: ManifestMetadata
    required: false

  # Site slots
  name:
    range: string
    required: true

  description:
    range: string

  homepage:
    range: url
    required: true

  contact:
    range: email
    required: false

  robots_txt_hints:
    description: >-
      Optional hints for discovery via robots.txt.
      Can include entries like "Disallow: /private" or "User-agent: *" directives
      that indicate which paths should be exposed to AI agents.
    range: string
    multivalued: true
    required: false

  well_known_endpoint:
    description: >-
      Optional endpoint for /.well-known/arw-manifest.json discovery.
      When specified, indicates that the manifest is also available at this
      standardized location for automated discovery by AI agents and platforms.
    range: url
    required: false

  # Content slots
  url:
    range: url
    required: true

  machine_view:
    range: url
    required: true

  purpose:
    range: string

  priority:
    range: Priority

  chunks:
    range: Chunk
    multivalued: true

  # Chunk slots
  id:
    range: string
    required: true

  heading:
    range: string

  chunk_description:
    name: description
    range: string

  # Action slots
  endpoint:
    range: url
    required: true

  method:
    range: HTTPMethod
    required: true

  auth:
    range: AuthType
    required: true

  scopes:
    range: string
    multivalued: true

  schema:
    range: url

  action_name:
    name: name
    range: string
    required: true

  action_description:
    name: description
    range: string

  # Protocol slots
  type:
    range: string
    required: true

  protocol_name:
    name: name
    range: string
    required: true

  endpoint_url:
    name: endpoint
    range: url
    required: true

  protocol_schema:
    name: schema
    range: url

  # OAuth slots
  authorization_url:
    range: url
    required: true

  token_url:
    range: url
    required: true

  oauth_scopes:
    name: scopes
    range: OAuthScope
    multivalued: true

  # Policy slots
  training:
    range: TrainingPolicy
    required: true

  inference:
    range: InferencePolicy
    required: true

  attribution:
    range: AttributionPolicy
    required: true

  rate_limits:
    range: RateLimits

  # NEW: Metadata slots
  serialization_formats:
    description: Supported serialization formats
    range: SerializationFormat
    multivalued: true

  preferred_format:
    description: Preferred serialization format
    range: SerializationFormat

  discovery_mechanisms:
    description: Available discovery mechanisms
    range: DiscoveryMethod
    multivalued: true

  mime_types:
    description: MIME type configuration
    range: MimeTypeConfig

  http_headers:
    description: Required HTTP headers
    range: HTTPHeaders

  platform_compatibility:
    description: Platform compatibility information
    range: PlatformCompatibility

  agent_compatibility:
    description: AI agent compatibility information
    range: AgentCompatibility

  # MimeTypeConfig slots
  preferred_mime:
    name: preferred
    range: MimeType

  fallback_mime:
    name: fallback
    range: MimeType
    multivalued: true

  # HTTPHeaders slots
  ai_version:
    description: AI-Version header value
    range: string

  ai_profile:
    description: AI-Profile header value
    range: string

  ai_format:
    description: AI-Format header value
    range: string

  # PlatformCompatibility slots
  tested_platforms:
    range: TestedPlatform
    multivalued: true

  # AgentCompatibility slots
  tested_agents:
    range: TestedAgent
    multivalued: true

  # TestedPlatform slots
  platform_name:
    name: name
    range: string
    required: true

  platform_version:
    name: version
    range: string

  compatibility_status:
    name: status
    range: string

  tested_date:
    range: string

  # TestedAgent slots
  agent_name:
    name: name
    range: string
    required: true

  agent_version:
    name: version
    range: string

  agent_status:
    name: status
    range: string

  test_results_url:
    range: url

classes:
  ARWManifest:
    description: Root manifest for Agent-Ready Web v0.2
    tree_root: true
    slots:
      - version
      - profile
      - site
      - content
      - actions
      - protocols
      - oauth
      - policies
      - metadata

  Site:
    description: Site metadata
    slots:
      - name
      - description
      - homepage
      - contact
      - robots_txt_hints
      - well_known_endpoint

  ContentItem:
    description: Declarative mapping of human page to machine view and chunks
    slots:
      - url
      - machine_view
      - purpose
      - priority
      - chunks

  Chunk:
    description: Addressable content segment
    slots:
      - id
      - heading
      - description

  Action:
    description: OAuth-protected operation
    slots:
      - id
      - name
      - description
      - endpoint
      - method
      - auth
      - scopes
      - schema

  Protocol:
    description: Protocol interoperability advertisement
    slots:
      - name
      - type
      - endpoint
      - schema

  OAuthScope:
    description: OAuth scope definition
    slots:
      - name
      - description

  OAuthConfig:
    description: OAuth2 configuration
    slots:
      - authorization_url
      - token_url
      - scopes

  TrainingPolicy:
    description: Training usage policy
    slots:
      - allowed
      - note

  InferencePolicy:
    description: Inference usage policy
    slots:
      - allowed
      - restrictions

  AttributionPolicy:
    description: Attribution requirements
    slots:
      - required
      - format
      - template

  RateLimits:
    description: Rate limit declarations
    slots:
      - authenticated
      - unauthenticated

  Policies:
    description: Aggregated policies for training, inference, attribution, rate limits
    slots:
      - training
      - inference
      - attribution
      - rate_limits

  # NEW CLASSES for v0.2
  ManifestMetadata:
    description: Format, discovery, and compatibility metadata
    slots:
      - serialization_formats
      - preferred_format
      - discovery_mechanisms
      - mime_types
      - http_headers
      - platform_compatibility
      - agent_compatibility

  MimeTypeConfig:
    description: MIME type configuration
    slots:
      - preferred
      - fallback

  HTTPHeaders:
    description: Required HTTP headers for ARW
    slots:
      - ai_version
      - ai_profile
      - ai_format

  PlatformCompatibility:
    description: Platform compatibility tracking
    slots:
      - tested_platforms

  AgentCompatibility:
    description: AI agent compatibility tracking
    slots:
      - tested_agents

  TestedPlatform:
    description: Platform testing information
    slots:
      - name
      - version
      - status
      - tested_date

  TestedAgent:
    description: AI agent testing information
    slots:
      - name
      - version
      - status
      - test_results_url

# Schema annotations
annotations:
  schema_version: 0.1
  backward_compatible: true
  comment: >-
    LinkML Schema for Agent-Ready Web (ARW) manifests.
    Supports dual YAML/JSON format serialization.
    Discovery mechanisms include robots.txt hints and /.well-known/arw-manifest.json endpoints.
    Contact field is optional to support sites without dedicated AI contact information.
  major_features:
    - Dual YAML/JSON format support (YAML: text/plain, JSON: application/json)
    - Optional robots.txt hints for discovery mechanism guidance
    - Optional well-known endpoint for /.well-known/arw-manifest.json discovery
    - Contact field optional for flexibility
    - Full metadata support for discovery and compatibility tracking
